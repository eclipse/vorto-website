<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Connecting a GrovePi to Eclipse Hono - Eclipse Vorto</title>
    <meta name="generator" content="Hugo 0.37.1" />

    
    <meta name="description" content="Describe. Share. Integrate.">
    
    <link rel="canonical" href="https://www.eclipse.org/vorto/tutorials/grovepi/">
    
    <meta name="author" content="The Eclipse Vorto Project">
    

    <meta property="og:url" content="https://www.eclipse.org/vorto/tutorials/grovepi/">
    <meta property="og:title" content="Eclipse Vorto">
    <meta property="og:image" content="https://www.eclipse.org/vorto/images/vorto.png">
    <meta name="apple-mobile-web-app-title" content="Eclipse Vorto">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="https://www.eclipse.org/vorto/images/vorto.ico">
    <link rel="icon" type="image/x-icon" href="https://www.eclipse.org/vorto/images/vorto.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('https://www.eclipse.org/vorto/fonts/icon.eot');
        src: url('https://www.eclipse.org/vorto/fonts/icon.eot')
               format('embedded-opentype'),
             url('https://www.eclipse.org/vorto/fonts/icon.woff')
               format('woff'),
             url('https://www.eclipse.org/vorto/fonts/icon.ttf')
               format('truetype'),
             url('https://www.eclipse.org/vorto/fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="https://www.eclipse.org/vorto/stylesheets/application.css">
    <link rel="stylesheet" href="https://www.eclipse.org/vorto/stylesheets/temporary.css">
    <link rel="stylesheet" href="https://www.eclipse.org/vorto/stylesheets/palettes.css">
    <link rel="stylesheet" href="https://www.eclipse.org/vorto/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu&#43;Mono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <link rel="stylesheet" href="https://www.eclipse.org/vorto/css/vorto.css">
    
    <link rel="stylesheet" href="//www.eclipse.org/eclipse.org-common/themes/solstice/public/stylesheets/vendor/cookieconsent/cookieconsent.min.css">
    
    <script src="https://www.eclipse.org/vorto/javascripts/modernizr.js"></script>
    <script src="//www.eclipse.org/eclipse.org-common/themes/solstice/public/javascript/vendor/cookieconsent/default.min.js"></script>

    

  </head>
  <body class="palette-primary-blue palette-accent-teal">



	
	


<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Connecting a GrovePi to Eclipse Hono
      </div>
    </div>

    
    <div class="button button-twitter" role="button" aria-label="Twitter">
       <a href="https://twitter.com/VortoIoT" title="@VortoIoT on Twitter" target="_blank" class="toggle-button icon icon-twitter"></a>
    </div>
    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/eclipse/vorto" title="@eclipse/vorto on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="https://www.eclipse.org/vorto/" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="https://www.eclipse.org/vorto/images/vorto.png">
        </div>
      
      <div class="name">
        <strong>Eclipse Vorto </strong>
        
          <br>
          eclipse/vorto
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            <a href="http://vorto.eclipse.org" title="Repository" data-action="download">
              <i class="icon icon-search"></i> Sandbox
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/eclipse/vorto" target="_blank" title="Vorto on GitHub" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="What is Vorto" href="https://www.eclipse.org/vorto/introduction">
	
	What is Vorto
</a>



  
</li>



<li>
  
    



<a  title="Getting started" href="https://www.eclipse.org/vorto/gettingstarted/">
	
	Getting started
</a>



  
</li>



<li>
  
    



<a  title="Tutorials" href="https://www.eclipse.org/vorto/tutorials/">
	
	Tutorials
</a>



  
</li>



<li>
  
    



<a  title="User Guide" href="https://www.eclipse.org/vorto/userguide/">
	
	User Guide
</a>



  
</li>



<li>
  
    



<a  title="Developer Guide" href="https://www.eclipse.org/vorto/developerguide">
	
	Developer Guide
</a>



  
</li>



<li>
  
    



<a  title="Community" href="https://www.eclipse.org/vorto/community/">
	
	Community
</a>



  
</li>



<li>
  
    



<a  title="Release Notes" href="https://www.eclipse.org/vorto/release-notes/">
	
	Release Notes
</a>



  
</li>



<li>
  
    



<a  title="Reference Documentation" href="https://www.eclipse.org/vorto/appendix/">
	
	Reference Documentation
</a>



  
</li>


        </ul>
        

        
        <hr>
        <span class="section">Build Status</span>
        
        <ul>
          
          <li>
            <a href="https://ci.eclipse.org/vorto" title="Eclipse Build Status" target="_blank">Jenkins@Eclipse</a>
          </li>
          
          <li>
            <a href="https://travis-ci.org/eclipse/vorto" title="Travis Build Status" target="_blank">
              <img src="https://travis-ci.org/eclipse/vorto.svg?branch=development" />
            </a>
          </li>
          <li>
            <a href="https://maven-badges.herokuapp.com/maven-central/org.eclipse.vorto/parent" title="Travis Build Status" target="_blank">
              <img src="https://maven-badges.herokuapp.com/maven-central/org.eclipse.vorto/parent/badge.svg" />
            </a>
          </li>
        </ul>
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>Connecting a GrovePi to Eclipse Hono </h1>

			<p>This tutorial explains how to generate a simple Python application for you GrovePi that sends sensor data to Eclipse Hono using MQTT.</p>

<p></p>

<h2 id="prerequisites">Prerequisites</h2>

<ul>
<li><p><a href="https://www.python.org/">Python 3.x</a></p></li>

<li><p>IDEs - for Python: <a href="https://code.visualstudio.com/docs/languages/python">Visual Studio Code with the Python extension</a></p></li>

<li><p><a href="https://eclipse.org/paho/clients/python/">Paho Python Client</a></p></li>

<li><p><a href="https://www.dexterindustries.com/grovepi/">GrovePi Sensor Kit</a></p></li>
</ul>

<h3 id="1-setup-your-device">1.  Setup your device.</h3>

<p>In this example Raspberry Pi is used but you can use any device which can run python.</p>

<ul>
<li><a href="https://www.raspberrypi.org/learning/software-guide/">Install raspbian on the Raspberry Pi</a>.</li>
<li><a href="https://www.raspberrypi.org/learning/software-guide/wifi/">Connect the pi to wifi</a>.</li>
<li><a href="https://www.raspberrypi.org/documentation/remote-access/ssh/">Enable ssh connection on your pi</a> .</li>
<li><a href="#installation-of-grovepi-required-modules">Install python and required modules</a>.

<br /></li>
</ul>

<h3 id="2-setup-your-development-environment-on-your-development-machine">2. Setup your development environment (on your development machine).</h3>

<ul>
<li><a href="https://code.visualstudio.com/docs/languages/python">Install Visual Studio Code with the Python extension</a>.</li>
<li><a href="#installation-of-grovepi-required-modules">Install python and required modules</a>.
<br /></li>
</ul>

<h3 id="3-generate-application-code-using-the-python-generator">3.  Generate application code using the Python generator.</h3>

<ul>
<li>Open the <a href="http://vorto.eclipse.org/#/details/org.eclipse.vorto.tutorial/DistanceSensor/1.0.0">Distance Sensor</a> in the Vorto Repository.</li>
<li>Click <strong>Eclipse Hono Generator</strong> and choose <strong>Python</strong>.</li>
<li>Click <strong>Generate</strong></li>
<li>Download the ZIP file and extract the source code.</li>
<li><a href="https://letsencrypt.org/certs/lets-encrypt-x3-cross-signed.pem.txt">Get the certificate</a> and copy and paste the content in a .crt file where you stored your source code</li>
</ul>

<h3 id="4-registering-to-eclipse-hono">4. Registering to Eclipse Hono</h3>

<p>Eclipse Hono provides a sandbox environment, which we can use in this tutorial to integrate the GrovePi with. So before we can send any data, we must register the device in Eclipse Hono. We use <code>vortodemo</code> as a <strong>Hono tenant</strong> and <code>1234</code> as a <strong>device ID</strong>:</p>

<p><strong>Registering our Device</strong></p>

<pre><code class="language-sh">curl -X POST http://hono.eclipse.org:28080/registration/vortodemo
-i -H 'Content-Type: application/json'
-d '{&quot;device-id&quot;: &quot;1234&quot;}'
</code></pre>

<p><strong>Adding device credentials</strong></p>

<pre><code class="language-sh">PWD_HASH=$(echo -n &quot;S3cr3t&quot; | openssl dgst -binary -sha512 | base64 | tr -d '\n') 
curl -X POST http://hono.eclipse.org:28080/credentials/vortodemo
-i -H 'Content-Type: application/json'
-d 'JSON request payload' 
</code></pre>

<p>JSON request payload:</p>

<pre><code class="language-sh">{
  &quot;device-id&quot;: &quot;1234&quot;,
  &quot;auth-id&quot;: &quot;1234&quot;,
  &quot;type&quot;: &quot;hashed-password&quot;,
  &quot;secrets&quot;: [
    {
      &quot;hash-function&quot;: &quot;sha-512&quot;,
      &quot;pwd-hash&quot;: &quot;'$PWD_HASH'&quot;
    }
  ]
}
</code></pre>

<h3 id="5-install-grovepi-python-dependencies-on-the-raspberry-pi">5.  Install GrovePi Python dependencies on the Raspberry Pi.</h3>

<ul>
<li>Install necessary dependencies for GrovePi on the Raspberry Pi. To do so, just execute the commands</li>
</ul>

<pre><code class="language-sh">sudo curl https://raw.githubusercontent.com/DexterInd/Raspbian_For_Robots/master
upd_script/fetch_grovepi.sh | bash
       
sudo reboot
</code></pre>

<ul>
<li>You can find full instructions <a href="https://www.dexterindustries.com/GrovePi/get-started-with-the-grovepi/setting-software/">here</a>.
<br /></li>
</ul>

<h3 id="6-connect-the-sensor-to-the-raspberry-pi">6.  Connect the sensor to the Raspberry Pi.</h3>

<ul>
<li>Select a sensor from the kit.</li>
<li>Connect the selected sensor to the Raspberry Pi. In this tutorial, ultrasonic sensor is used, which measures a non-contact distance. The ultrasonic sensor is connected to <strong>pin “3”</strong> on the GrovePi.
<br /></li>
</ul>

<h3 id="7-update-the-application-code">7.  Update the application code.</h3>

<p>The ZIP file contains the necessary libraries for your project and a sample Python main program. The main program is named after the thing type and stored in the main directory of the project. Open this file in your editor of choice to make the necessary adjustments.</p>

<p>Code sections which can be customized for your needs are marked with</p>

<pre><code class="language-sh">        ### BEGIN SAMPLE CODE
</code></pre>

<p>and</p>

<pre><code class="language-sh">    
        ### END SAMPLE CODE
</code></pre>

<ul>
<li>Import the GrovePi dependencies:</li>
</ul>

<pre><code class="language-sh">      from grovepi import *
</code></pre>

<ul>
<li>Update the Device Configuration values like:
<br /></li>
</ul>

<pre><code class="language-sh">      hono_tenant = &quot;vortodemo&quot;
      hono_password = &quot;S3cr3t&quot;
      hono_endpoint = &quot;ssl://hono.eclipse.org:8883&quot;
      hono_deviceId = &quot;1234&quot;
      hono_clientId = hono_deviceId
      hono_authId = hono_deviceId + &quot;@&quot; + hono_tenant
      hono_certificatePath = &quot;PATH TO YOUR CERTIFICATE&quot;
      ditto_namespace = &quot;org.eclipse.vorto&quot;
</code></pre>

<ul>
<li>Define a constant and assign the pin number of the pin to which the sensor is physically connected:</li>
</ul>

<pre><code class="language-sh">      # constants
      ultrasonic_ranger = 3
</code></pre>

<ul>
<li><p>The function <code>periodicAction</code> is called periodically every <code>timePeriod</code> seconds. It is meant to periodically read your sensor’s values and transmit them using the thing type as a data model layer and the Paho MQTT Client.</p></li>

<li><p>Read the data and assign it to the functional block properties:</p></li>
</ul>

<pre><code class="language-sh">      infomodel.distance.sensorValue = ultrasonicRead(ultrasonic_ranger)
      infomodel.distance.sensorUnits = &quot;cm&quot;
</code></pre>

<ul>
<li>The variable <code>timePeriod</code> is set further down in the file. In this example, the variable <code>timePeriod</code> is set to 10.
<br /></li>
</ul>

<h3 id="8-run-the-application-on-the-device">8.  Run the application on the device.</h3>

<ul>
<li>Copy the code to the device (<a href="https://www.raspberrypi.org/documentation/remote-access/ssh/scp.md">How to copy files to Raspberry Pi?</a>).</li>
<li>Open the Terminal and navigate to the source code folder.</li>
<li>Run the application by typing the following command:</li>
</ul>

<pre><code class="language-sh">      python GENERATED_MAIN_PYTHON_FILE.py
</code></pre>

<p><code>example output:</code></p>

<p><img src="https://www.eclipse.org/vorto/images/tutorials/grovepi/output_screenhot_grovepi.png" alt="grovePi Screenshot" /></p>

<ul>
<li>Follow <a href="https://www.eclipse.org/hono/dev-guide/java_client_consumer/">Consuming Messages from Java for Hono</a> to receive the device data in Eclipse Hono.</li>
</ul>

<h2 id="installation-of-grovepi-required-modules">Installation of GrovePi required Modules</h2>

<ul>
<li><p>Download and install the latest version of Python 3.x from the official <a href="https://www.python.org/">Python website</a></p></li>

<li><p><a href="https://packaging.python.org/tutorials/installing-packages/#install-pip-setuptools-and-wheel">Install pip</a></p></li>

<li><p>Install Visual C++ Build Tools(<a href="http://landinghub.visualstudio.com/visual-cpp-build-tools">http://landinghub.visualstudio.com/visual-cpp-build-tools</a>). This is a pre-requisite for installing netifaces.</p></li>

<li><p>Install the required Python modules</p>

<ul>
<li><a href="https://www.eclipse.org/paho/clients/python/">Eclipse paho</a></li>

<li><p><a href="https://pypi.python.org/pypi/netifaces">netinterfaces</a></p>

<ul>
<li><p>open terminal or console and type the following command</p>

<pre><code>pip install paho-mqtt
pip install netifaces
</code></pre></li>
</ul></li>
</ul></li>
</ul>

<h2 id="what-s-next">What&rsquo;s next?</h2>

<ul>
<li><a href="https://www.eclipse.org/vorto/tutorials/arduino/">Connect an ESP8266 to Eclipse Hono</a></li>
</ul>

			<aside class="copyright" role="note">
  <div class="logo">
    <a href="https://www.eclipse.org" target="_blank">
      <img src="https://www.eclipse.org/vorto/images/eclipse_logo_colour.png" />
    </a>
  </div>
  <p class="notice">
    
    &copy; 2018 The Eclipse Vorto Project &ndash;
    
    Documentation built with
    <a href="https://www.gohugo.io" target="_blank">Hugo</a>
    using the
    <a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
  </p>
  <p class="quickLinks">
    <a href="http://www.eclipse.org/legal/privacy.php" target="_blank">
      &gt; Privacy Policy
    </a>
    <a href="http://www.eclipse.org/legal/termsofuse.php" target="_blank">
      &gt; Terms of Use
    </a>
    <a href="http://www.eclipse.org/legal/copyright.php" target="_blank">
      &gt; Copyright Agent
    </a>
    <a href="http://www.eclipse.org/legal" target="_blank">
      &gt; Legal
    </a>
    <a href="https://www.eclipse.org/legal/epl-2.0/" target="_blank">
      &gt; License
    </a>
  </p>
</aside>


			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="https://www.eclipse.org/vorto/tutorials/arduino/" title="Connecting an ESP8266 to Eclipse Hono">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              Connecting an ESP8266 to Eclipse Hono
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="https://www.eclipse.org/vorto/tutorials/payloadmapping/" title="Mapping device payload to standardized Vorto Function Blocks">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              Mapping device payload to standardized Vorto Function Blocks
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = 'https:\/\/www.eclipse.org\/vorto\/';
      var repo_id  = 'eclipse\/vorto';
    
    </script>

    <script src="https://www.eclipse.org/vorto/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>

    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

